# OCT 横向分辨率计量 - 已知问题与优化方向

**版本**: v1.0  
**更新日期**: 2026-01-20

---

## 1. 核心问题：SNR 截断效应

### 1.1 问题描述

深层低 SNR 数据产生人为偏小的 FWHM 读数，导致系统评估结果虚高。

### 1.2 根本原因

1. OCT 信号随深度指数衰减 (Sensitivity Roll-off)
2. 深层光斑边缘被淹没在噪声底
3. 算法只能检测到光斑中心尖峰
4. 对残缺光斑拟合得到虚假的窄宽度

### 1.3 影响

| 指标 | 浅层（高 SNR） | 深层（低 SNR） |
|------|---------------|---------------|
| 测量值 | 准确 | 偏小（假优） |
| 置信度 | 高 | 低 |
| 应采信 | ✓ | ✗ |

---

## 2. 优化方案

### 2.1 SNR 置信度加权

**思路**: 高 SNR 数据优先，深层数据降权或剔除。

**实现建议**:

- 设定"计量级"阈值: SNR > 20.0
- 只有通过黄金阈值的微球参与最终统计

### 2.2 高置信度区域 (HCR) 自动选择

**思路**: 自动识别 SNR 最高的深度区间，仅报告该区间的分辨率。

**步骤**:

1. 将 Z 轴按 50µm 分 bin
2. 计算每个 bin 的中位 SNR
3. 选择 SNR 最高的 bin
4. 报告该 bin 的统计结果

### 2.3 Roll-off 补偿

**思路**: 预处理图像，拟合衰减曲线并补偿。

$$ I(z) = I_0 e^{-\alpha z} $$

归一化后深层对比度提升，筛选更公平。

---

## 3. 其他待解决问题

### 3.1 GUI 文件对话框偶发卡顿

**状态**: 待调查  
**现象**: 打开图像时 GUI 偶发无响应  
**可能原因**: 文件系统延迟、Qt 线程问题

### 3.2 大图像处理速度

**状态**: 待优化  
**现象**: 4K+ 图像分析耗时较长  
**建议**:

- 降采样预处理
- 并行化筛选流程

### 3.3 批处理支持

**状态**: 计划中  
**需求**: 支持多图像批量分析、CSV 导出

---

## 4. 版本路线图

| 版本 | 目标 | 状态 |
|------|------|------|
| v1.0 | 代码规范化、文档整合 | ✓ 完成 |
| v1.1 | SNR 置信度加权 | 计划中 |
| v1.2 | HCR 自动选择 | 计划中 |
| v2.0 | 批处理 + 报告导出 | 远期 |

---

## 5. 参考文档

- [算法优化方案 (中文)](ALGORITHM_IMPROVEMENT_PROPOSAL_CN.md)
- [Algorithm Improvement Proposal (EN)](ALGORITHM_IMPROVEMENT_PROPOSAL.md)
